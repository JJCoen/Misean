<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="David Svancer (George Mason Uni) adapted by Jim Coen" />


<title>Modelling with tidymodels</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Misean Cara Operations</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Integrity
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Common-Data-Problems.html">
        <span class="fa fa-clipboard-list"></span>
         
        Common Data Problems
      </a>
    </li>
    <li>
      <a href="Advanced-Data-Problems.html">Advanced Data Problems</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Data-Management.html">Data Management</a>
    </li>
    <li>
      <a href="Correlation.html">Correlation</a>
    </li>
    <li>
      <a href="Classification.html">Classification</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Training
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Interpretable-ML-Models.html">Machine Learning</a>
    </li>
    <li>
      <a href="Zoom-digital-skills.html">Zoom Example</a>
    </li>
    <li>
      <a href="Zoom-Training-Program.docx">Zoom Systematic Training</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/JJCoen/">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Modelling with tidymodels</h1>
<h3 class="subtitle">Linear Regression to model power plant output</h3>
<h4 class="author">David Svancer (George Mason Uni) adapted by Jim
Coen</h4>
<h4 class="date">Wednesday, November 16, 2022</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2022-11-16
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>Misean/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.0). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20221115code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20221115)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20221115code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20221115)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrong4fd7495">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong> 4fd7495
</a>
</p>
</div>
<div id="strongRepositoryversionstrong4fd7495"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version 4fd7495.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  analysis/images/check-code.png
    Untracked:  analysis/images/communicating.png
    Untracked:  analysis/images/corporate-finance-inst.png
    Untracked:  analysis/images/create-account.png
    Untracked:  analysis/images/lightning.png
    Untracked:  analysis/images/meetings.png
    Untracked:  analysis/images/schedule-meeting.png
    Untracked:  analysis/images/setting-up.png
    Untracked:  analysis/images/sign-in.jpg
    Untracked:  analysis/images/zoom-on-mobile.webp
    Untracked:  analysis/images/zoom.png
    Untracked:  data/employee_data.rds
    Untracked:  data/home_sales.rds
    Untracked:  data/leads_df.rds
    Untracked:  data/loan_df.rds
    Untracked:  data/power_df.csv
    Untracked:  data/telecom_df.rds
    Untracked:  data/trip.csv
    Untracked:  donation-tracking-excel-templates (2).zip
    Untracked:  donation-tracking-excel-templates/
    Untracked:  kickstarter.zip
    Untracked:  kickstarter/

Unstaged changes:
    Modified:   README.md
    Modified:   analysis/_site.yml

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/Correlation.Rmd</code>) and HTML
(<code>docs/Correlation.html</code>) files. If you’ve configured a
remote Git repository (see <code>?wflow_git_remote</code>), click on the
hyperlinks in the table below to view the files as they were in that
past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
html
</td>
<td>
4fd7495
</td>
<td>
JJCoen
</td>
<td>
2022-11-16
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
3ec87e6
</td>
<td>
JJCoen
</td>
<td>
2022-11-16
</td>
<td>
add Data Analysis and Training
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="purpose" class="section level1">
<h1>Purpose</h1>
<p>We are trying to predict power output given a set of readings from
various sensors in a gas-fired power generation plant. Power generation
is a complex process, and understanding and predicting power output is
an important element in managing a plant and its connection to the power
grid.</p>
<p>A combined cycle power plant (CCPP) is composed of gas turbines (GT),
steam turbines (ST) and heat recovery steam generators. In a CCPP, the
electricity is generated by gas and steam turbines, which are combined
in one cycle, and is transferred from one turbine to another. While the
Vacuum is colected from and has effect on the Steam Turbine, he other
three of the ambient variables effect the GT performance.</p>
<div id="business-understanding" class="section level2">
<h2>Business Understanding</h2>
<ol style="list-style-type: decimal">
<li>What is the effect of each sensor on power output?</li>
<li>Is there a critical sensor or threshold values for each sensor in
terms of power output?</li>
<li>Is it possible to predict, with low error, the power output of a
CCPP.</li>
</ol>
</div>
</div>
<div id="data-inspection" class="section level1">
<h1>Data Inspection</h1>
<div id="data-set-information" class="section level2">
<h2>Data Set Information:</h2>
<p>The data-set contains 9568 data points collected from a Combined
Cycle Power Plant over 6 years (2006-2011), when the power plant was set
to work with full load. Features consist of hourly average ambient
variables Temperature (T), Ambient Pressure (AP), Relative Humidity (RH)
and Exhaust Vacuum (V) to predict the net hourly electrical energy
output (EP) of the plant.</p>
<div id="data-dictionary" class="section level3">
<h3>Data Dictionary</h3>
<p>- Temperature (T) in the range 1.81°C and 37.11°C,<br />
- Ambient Pressure (AP) in the range 992.89-1033.30 milibar,<br />
- Relative Humidity (RH) in the range 25.56% to 100.16%<br />
- Exhaust Vacuum (V) in the range 25.36-81.56 cm Hg<br />
- Net hourly electrical energy output (EP) 420.26-495.76 MW<br />
The averages are taken from various sensors located around the plant
that record the ambient variables every second. The variables are given
without normalization.</p>
</div>
</div>
<div id="load" class="section level2">
<h2>Load</h2>
<p>Source: <a
href="https://archive.ics.uci.edu/ml/datasets/Combined+Cycle+Power+Plant">UCI
Machine Learning Repository Combined Cycle Power Plant Data Set</a></p>
<pre class="r"><code>if (!file.exists(&quot;./data/power_df.csv&quot;)) {
  power_df &lt;- read_excel(&quot;./data/Power-Plant/Folds5x2_pp.xlsx&quot;)
  write_csv(power_df, file = &quot;./data/power_df.csv&quot;)
  setDT(power_df)
} else {
  power_df &lt;- fread(&quot;./data/power_df.csv&quot;)
}
str(power_df)</code></pre>
<pre><code>Classes &#39;data.table&#39; and &#39;data.frame&#39;:  9568 obs. of  5 variables:
 $ AT: num  14.96 25.18 5.11 20.86 10.82 ...
 $ V : num  41.8 63 39.4 57.3 37.5 ...
 $ AP: num  1024 1020 1012 1010 1009 ...
 $ RH: num  73.2 59.1 92.1 76.6 96.6 ...
 $ PE: num  463 444 489 446 474 ...
 - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt; </code></pre>
<div id="randomly-sample-training-and-test-sets" class="section level3">
<h3>Randomly sample training and test sets</h3>
<ol style="list-style-type: decimal">
<li>Create an <code>rsample</code> object, <code>power_split</code>,
that contains the instructions for randomly splitting the
<code>home_sales</code> data into a training and test data-set.</li>
<li>Allocate 70% of the data into training and stratify the results by
<code>PE.</code></li>
</ol>
<pre class="r"><code># Create data split object
power_split &lt;- initial_split(power_df, prop = 0.7,
                     strata = PE)

# Create the training data
power_training &lt;- power_split %&gt;% 
  training()

# Create the test data
power_test &lt;- power_split %&gt;% 
  testing()

# Check the number of rows
nrow(power_training)</code></pre>
<pre><code>[1] 6696</code></pre>
<pre class="r"><code>nrow(power_test)</code></pre>
<pre><code>[1] 2872</code></pre>
</div>
</div>
<div id="target-variable" class="section level2">
<h2>Target Variable</h2>
<div id="distribution-of-outcome-variable-values"
class="section level3">
<h3><strong>Distribution of outcome variable values</strong></h3>
<p>Stratifying by the outcome variable when generating training and test
data-sets ensures that the outcome variable values have a similar range
in both data-sets.</p>
<ol style="list-style-type: decimal">
<li>Calculate the minimum, maximum, mean, and standard deviation of the
<code>PE</code> variable</li>
</ol>
<pre class="r"><code># Distribution of PE in training data
power_training %&gt;% 
  summarize(min_power_out = min(PE),
            max_power_out = max(PE),
            mean_power_out = mean(PE),
            sd_power_out = sd(PE)) </code></pre>
<pre><code>  min_power_out max_power_out mean_power_out sd_power_out
1           422           496            454           17</code></pre>
<pre class="r"><code>ggplot(data=power_training, aes(x = PE )) +
  geom_histogram(color=&quot;black&quot;, fill=&quot;white&quot;, bins=50) +
  geom_vline(aes(xintercept=mean(PE)), color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=1)</code></pre>
<p><img src="figure/Correlation.Rmd/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(\rightarrow\)</span> Target variable is
bi-modal.</p>
</div>
</div>
<div id="features" class="section level2">
<h2>Features</h2>
<div id="distribution" class="section level3">
<h3>Distribution</h3>
<p>Reshape <code>power_df</code> to long format with key value pairs</p>
<p>Create histograms</p>
<pre class="r"><code>ggplot(gather(power_training[, -(&quot;PE&quot;)]), aes(value)) + 
    geom_histogram(color=&quot;black&quot;, fill=&quot;white&quot;, bins=50) +
    facet_wrap(~key, scales = &#39;free_x&#39;)</code></pre>
<p><img src="figure/Correlation.Rmd/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(\rightarrow\)</span> right skew in RH can
be reduced with Box-Cox transformation.</p>
<p><span class="math inline">\(\rightarrow\)</span> AP has a normal
distribution while AT is approximately normal.</p>
</div>
</div>
<div id="relationship-between-features-and-target-variable"
class="section level2">
<h2>Relationship between features and target variable</h2>
<div id="check-for-outliers" class="section level3">
<h3>Check for outliers</h3>
<pre class="r"><code>grid.arrange(g1, g2, g3, g4, ncol = 2, nrow =2)</code></pre>
<p><img src="figure/Correlation.Rmd/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(\rightarrow\)</span> despite certain
points on the edges of the main clusters, there are no distinct
outliers.</p>
</div>
<div id="co-linearity-among-features" class="section level3">
<h3>Co-linearity among features</h3>
<pre class="r"><code># install.packages(&quot;corrr&quot;)
library(corrr)</code></pre>
<pre><code>
Attaching package: &#39;corrr&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:skimr&#39;:

    focus</code></pre>
<pre class="r"><code>power_training %&gt;%
       correlate() %&gt;%    # Create correlation data frame (cor_df)
       # focus(-PE, mirror = TRUE) %&gt;%  # Focus on cor_df without &#39;PE&#39;
       rearrange() %&gt;%  # rearrange by correlations
       shave() # Shave off the upper triangle for a clean result</code></pre>
<pre><code>Correlation computed with
• Method: &#39;pearson&#39;
• Missing treated using: &#39;pairwise.complete.obs&#39;</code></pre>
<pre><code># A tibble: 5 × 6
  term      AT      V     RH     AP    PE
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 AT    NA     NA     NA     NA        NA
2 V      0.843 NA     NA     NA        NA
3 RH    -0.541 -0.308 NA     NA        NA
4 AP    -0.515 -0.421  0.100 NA        NA
5 PE    -0.948 -0.869  0.388  0.526    NA</code></pre>
<p><span class="math inline">\(\rightarrow\)</span> high negative
correlation (-0.95) between atmospheric temp. and power outpupt.</p>
<p><span class="math inline">\(\rightarrow\)</span> high correlation
(0.84) between atmospheric temp. and exhaust vacuum.</p>
</div>
</div>
</div>
<div id="fit-a-linear-regression-model" class="section level1">
<h1>Fit a Linear Regression Model</h1>
<pre class="r"><code># Specify a logistic regression model
linear_model &lt;- linear_reg() %&gt;% 
  # Set the engine
  set_engine(&#39;lm&#39;) %&gt;% 
  # Set the mode
  set_mode(&#39;regression&#39;)

# Fit to training data
lm_fit &lt;- linear_model %&gt;% 
  fit(PE ~ AT + V + AP + RH,
      data = power_training)

# Print model fit object
lm_fit</code></pre>
<pre><code>parsnip model object


Call:
stats::lm(formula = PE ~ AT + V + AP + RH, data = data)

Coefficients:
(Intercept)           AT            V           AP           RH  
   454.6908      -1.9690      -0.2363       0.0618      -0.1563  </code></pre>
<div id="predicting-power-output" class="section level2">
<h2>Predicting power output</h2>
<p>After fitting a model using the training data, the next step is to
use it to make predictions on the test dataset. The test dataset acts as
a new source of data for the model and will allow you to evaluate how
well it performs.</p>
<p>Before you can evaluate model performance, you must add your
predictions to the test data-set.</p>
<ul>
<li>Create a tibble with the <code>PE</code> and all predictor columns
from the test data-set and the predicted home selling prices.</li>
</ul>
<pre class="r"><code># Predict power output
power_predictions &lt;- predict(lm_fit,
                            new_data = power_test)

# View predicted power output
power_predictions %&gt;% head()</code></pre>
<pre><code># A tibble: 6 × 1
  .pred
  &lt;dbl&gt;
1  451.
2  472.
3  442.
4  443.
5  467.
6  472.</code></pre>
<pre class="r"><code># Combine test data with predictions
power_test_results &lt;- power_test %&gt;% 
  bind_cols(power_predictions)

# View results
power_test_results %&gt;% head()</code></pre>
<pre><code>     AT    V   AP   RH  PE .pred
1: 20.9 57.3 1010 76.6 446   451
2: 10.8 37.5 1009 96.6 474   472
3: 26.3 59.4 1012 58.8 444   442
4: 25.7 58.6 1013 61.8 451   443
5: 14.4 52.8 1024 63.6 460   467
6: 14.0 38.5 1015 55.3 464   472</code></pre>
</div>
</div>
<div id="evaluating-model-performance" class="section level1">
<h1>Evaluating Model Performance</h1>
<div id="root-mean-squared-error-rmse" class="section level2">
<h2><strong>Root mean squared error (RMSE)</strong></h2>
<p>A common performance metric for regression models is the root mean
squared error, or RMSE. The RMSE estimates the average prediction error
of a model and is calculated with the rmse() function. To calculate the
RMSE on our mpg model, we pass <code>power_test_results</code> to the
<code>rmse</code>() function and specify hwy as the truth and
<code>.pred</code> as the estimate. We see that the average prediction
error of our model is about 4.57 MW for the estimated power output
values.</p>
</div>
<div id="r-squared-metric" class="section level2">
<h2><strong>R squared metric</strong></h2>
<p>Another important regression metric is R squared, also known as the
coefficient of determination.</p>
<ul>
<li>R squared measures the squared correlation between actual and
predicted values and</li>
<li>ranges from 0 to 1, where 1 indicates that all predictions equal the
true outcome values.</li>
<li>R squared is calculated with the <code>rsq</code>() function and
takes the same arguments as the <code>rmse</code>() function.</li>
</ul>
<pre class="r"><code># Print home_test_results
power_test_results %&gt;% head()</code></pre>
<pre><code>     AT    V   AP   RH  PE .pred
1: 20.9 57.3 1010 76.6 446   451
2: 10.8 37.5 1009 96.6 474   472
3: 26.3 59.4 1012 58.8 444   442
4: 25.7 58.6 1013 61.8 451   443
5: 14.4 52.8 1024 63.6 460   467
6: 14.0 38.5 1015 55.3 464   472</code></pre>
<pre class="r"><code># Calculate the RMSE metric
power_test_results %&gt;% 
  rmse(truth = PE, estimate = .pred)</code></pre>
<pre><code># A tibble: 1 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 rmse    standard        4.52</code></pre>
<pre class="r"><code># Calculate the R squared metric
power_test_results %&gt;% 
  rsq(truth = PE, estimate = .pred)</code></pre>
<pre><code># A tibble: 1 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 rsq     standard       0.931</code></pre>
</div>
<div id="r-squared-plots" class="section level2">
<h2><strong>R squared plots</strong></h2>
<p>R squared plots are a way to visualize R squared and consist of a
scatter plot with model predictions on the y-axis and true outcome
values on the x-axis.</p>
<ul>
<li><p>The line y = x is also plotted and represents the case where all
predictions and outcome values are equal, giving an R squared value of
1.</p></li>
<li><p>R squared plots are helpful for identifying problems with model
performance, such as non-linear relationships between the outcome
variable and predictors or regions where the model may be systematically
under or over-predicting the outcome value.</p></li>
<li><p><code>coord_obs_pred()</code> standardises the range on each
axis.</p></li>
</ul>
<pre class="r"><code># Create an R squared plot of model performance
ggplot(power_test_results, aes(x = PE, y = .pred)) +
  geom_point(alpha = 0.5) + 
  geom_abline(color = &#39;blue&#39;, linetype = 2) +
  coord_obs_pred() +
  labs(x = &#39;Actual Power Output&#39;, y = &#39;Predicted Power Output&#39;)</code></pre>
<p><img src="figure/Correlation.Rmd/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(\rightarrow\)</span> There are a few
outliers where the model over-predicts power output.</p>
</div>
<div id="streamlining-model-fitting" class="section level2">
<h2><strong>Streamlining model fitting</strong></h2>
<p>The <code>last_fit</code>() function is used to streamline the model
fitting and evaluation process in tidymodels.</p>
<ul>
<li>It takes a parnsip model object,</li>
<li>model formula, and</li>
<li>rsample data split object</li>
</ul>
<p>and performs the following steps.</p>
<ol style="list-style-type: decimal">
<li>It creates training and test datasets,</li>
<li>fits the model to the training data,</li>
<li>calculates metrics and predictions on the test data, and</li>
<li>returns an object with all the results.</li>
</ol>
<p>To fit our linear regression model on the mpg data, we pass the
<code>lm_model</code> parsnip object to <code>last_fit</code>(), specify
our model formula, and provide the mpg_split data split object.</p>
<pre class="r"><code># Define a linear regression model
linear_model &lt;- linear_reg() %&gt;% 
  set_engine(&#39;lm&#39;) %&gt;% 
  set_mode(&#39;regression&#39;)

# Train linear_model with last_fit()
linear_fit &lt;- linear_model %&gt;% 
  last_fit(PE ~ ., split = power_split)

# Collect predictions and view results
predictions_df &lt;- linear_fit %&gt;% collect_predictions()
predictions_df %&gt;% head()</code></pre>
<pre><code># A tibble: 6 × 5
  id               .pred  .row    PE .config             
  &lt;chr&gt;            &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;               
1 train/test split  451.     4  446. Preprocessor1_Model1
2 train/test split  472.     5  474. Preprocessor1_Model1
3 train/test split  442.     6  444. Preprocessor1_Model1
4 train/test split  443.    14  451. Preprocessor1_Model1
5 train/test split  467.    19  460. Preprocessor1_Model1
6 train/test split  472.    20  464. Preprocessor1_Model1</code></pre>
<pre class="r"><code># Make an R squared plot using predictions_df
ggplot(predictions_df, aes(x = PE, y = .pred)) + 
  geom_point(alpha = 0.5) + 
  geom_abline(color = &#39;blue&#39;, linetype = 2) +
  coord_obs_pred() +
  labs(x = &#39;Actual Power Output&#39;, y = &#39;Predicted Power Output&#39;)</code></pre>
<p><img src="figure/Correlation.Rmd/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="collecting-metrics" class="section level2">
<h2><strong>Collecting metrics</strong></h2>
<p>Once the model is trained with the last_fit() function, we pass the
lm_last_fit object to the collect_metrics() function to get a tibble
with calculated metrics on the test data. The default metrics for
regression models are RMSE and R squared and are always stored in the
column named dot-estimate. We get the same performance metrics on the
mpg_test data as before, just with a lot less work!</p>
<pre class="r"><code>linear_fit %&gt;% collect_metrics()</code></pre>
<pre><code># A tibble: 2 × 4
  .metric .estimator .estimate .config             
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 rmse    standard       4.52  Preprocessor1_Model1
2 rsq     standard       0.931 Preprocessor1_Model1</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.1 (2022-06-23 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 22000)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] corrr_0.4.4        yardstick_1.0.0    workflowsets_0.2.1 workflows_0.2.6   
 [5] tune_0.2.0         rsample_1.0.0      parsnip_1.0.0      modeldata_0.1.1   
 [9] infer_1.0.2        dials_1.0.0        scales_1.2.1       broom_1.0.0       
[13] tidymodels_0.2.0   forcats_0.5.1      stringr_1.4.1      purrr_0.3.5       
[17] tidyr_1.2.1        tibble_3.1.8       tidyverse_1.3.1    recipes_0.2.0     
[21] caret_6.0-92       lattice_0.20-45    skimr_2.1.4        kableExtra_1.3.4  
[25] data.table_1.14.2  visdat_0.5.3       gridExtra_2.3      ggplot2_3.3.6     
[29] dplyr_1.0.10       readr_2.1.3        readxl_1.4.0       workflowr_1.7.0   

loaded via a namespace (and not attached):
  [1] backports_1.4.1      systemfonts_1.0.4    plyr_1.8.7          
  [4] repr_1.1.4           splines_4.2.1        listenv_0.8.0       
  [7] digest_0.6.29        foreach_1.5.2        htmltools_0.5.2     
 [10] fansi_1.0.3          magrittr_2.0.3       tzdb_0.3.0          
 [13] globals_0.15.1       modelr_0.1.8         gower_1.0.0         
 [16] svglite_2.1.0        hardhat_1.2.0        colorspace_2.0-3    
 [19] rvest_1.0.2          haven_2.5.0          xfun_0.31           
 [22] callr_3.7.2          crayon_1.5.2         jsonlite_1.8.2      
 [25] survival_3.3-1       iterators_1.0.14     glue_1.6.2          
 [28] registry_0.5-1       gtable_0.3.1         ipred_0.9-13        
 [31] webshot_0.5.3        future.apply_1.9.0   DBI_1.1.3           
 [34] Rcpp_1.0.9           viridisLite_0.4.1    GPfit_1.0-8         
 [37] stats4_4.2.1         lava_1.6.10          prodlim_2019.11.13  
 [40] httr_1.4.3           ellipsis_0.3.2       pkgconfig_2.0.3     
 [43] farver_2.1.1         nnet_7.3-17          sass_0.4.1          
 [46] dbplyr_2.2.1         utf8_1.2.2           tidyselect_1.2.0    
 [49] labeling_0.4.2       rlang_1.0.6          DiceDesign_1.9      
 [52] reshape2_1.4.4       later_1.3.0          munsell_0.5.0       
 [55] cellranger_1.1.0     tools_4.2.1          cli_3.3.0           
 [58] generics_0.1.3       evaluate_0.17        fastmap_1.1.0       
 [61] yaml_2.3.5           ModelMetrics_1.2.2.2 processx_3.7.0      
 [64] knitr_1.39           fs_1.5.2             future_1.26.1       
 [67] nlme_3.1-157         whisker_0.4          xml2_1.3.3          
 [70] compiler_4.2.1       rstudioapi_0.13      reprex_2.0.1        
 [73] lhs_1.1.5            bslib_0.3.1          stringi_1.7.8       
 [76] highr_0.9            ps_1.7.1             Matrix_1.4-1        
 [79] vctrs_0.4.1          pillar_1.8.1         lifecycle_1.0.3     
 [82] furrr_0.3.0          jquerylib_0.1.4      seriation_1.3.6     
 [85] httpuv_1.6.5         R6_2.5.1             promises_1.2.0.1    
 [88] TSP_1.2-1            parallelly_1.32.0    codetools_0.2-18    
 [91] MASS_7.3-57          assertthat_0.2.1     rprojroot_2.0.3     
 [94] withr_2.5.0          mgcv_1.8-40          parallel_4.2.1      
 [97] hms_1.1.2            grid_4.2.1           rpart_4.1.16        
[100] timeDate_3043.102    class_7.3-20         rmarkdown_2.14      
[103] git2r_0.30.1         getPass_0.2-2        pROC_1.18.0         
[106] lubridate_1.8.0      base64enc_0.1-3     </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
