<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jim Coen" />


<title>Donations Analysis</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Misean Cara Operations</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Integrity
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Common-Data-Problems.html">
        <span class="fa fa-clipboard-list"></span>
         
        Common Data Problems
      </a>
    </li>
    <li>
      <a href="Advanced-Data-Problems.html">Advanced Data Problems</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Data-Management.html">Data Management</a>
    </li>
    <li>
      <a href="Donations-Dashboard.html">Donations Dashboard</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Training
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Interpretable-ML-Models.html">Machine Learning</a>
    </li>
    <li>
      <a href="Zoom-digital-skills.html">Zoom Example</a>
    </li>
    <li>
      <a href="Zoom-Training-Program.docx">Zoom Systematic Training</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/JJCoen/Misean">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Donations Analysis</h1>
<h3 class="subtitle">Data management and analysis of Indian political
party donations</h3>
<h4 class="author">Jim Coen</h4>
<h4 class="date">Wednesday, November 23, 2022</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2022-11-23
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>Misean/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.0). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted
changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges"
class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of
the R Markdown file created these results, you’ll want to first commit
it to the Git repo. If you’re still working on the analysis, you can
ignore this warning. When you’re finished, you can run
<code>wflow_publish</code> to commit the R Markdown file and build the
HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20221115code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20221115)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20221115code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20221115)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomJJCoenMiseantreeb5753a41b658f1ddca3655113c5bdf9af6514302targetblankb5753a4a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/JJCoen/Misean/tree/b5753a41b658f1ddca3655113c5bdf9af6514302" target="_blank">b5753a4</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomJJCoenMiseantreeb5753a41b658f1ddca3655113c5bdf9af6514302targetblankb5753a4a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/JJCoen/Misean/tree/b5753a41b658f1ddca3655113c5bdf9af6514302" target="_blank">b5753a4</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/.Rhistory
    Ignored:    data/.Rhistory

Untracked files:
    Untracked:  Establishing key performance indicators for charities.pdf
    Untracked:  code/rsconnect/
    Untracked:  data/home_sales.rds
    Untracked:  data/leads_df.rds
    Untracked:  data/loan_df.rds
    Untracked:  data/power_df.csv
    Untracked:  data/reading-sheets.pdf
    Untracked:  data/readr-cheat-sheet.pdf
    Untracked:  data/telecom_df.rds
    Untracked:  data/trip.csv

Unstaged changes:
    Modified:   analysis/Data-Management.Rmd
    Modified:   code/Donations-Dashboard.Rmd
    Modified:   code/Donations-Dashboard.html
    Modified:   data/donations-India-update.xlsx

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/Data-Management.Rmd</code>) and
HTML (<code>docs/Data-Management.html</code>) files. If you’ve
configured a remote Git repository (see <code>?wflow_git_remote</code>),
click on the hyperlinks in the table below to view the files as they
were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/JJCoen/Misean/032de5a65037ad6d8259986f34ef86362c20697c/docs/Data-Management.html" target="_blank">032de5a</a>
</td>
<td>
JJCoen
</td>
<td>
2022-11-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/JJCoen/Misean/4a8d6862206c29d18212f01b5e42c54b96896b5e/docs/Data-Management.html" target="_blank">4a8d686</a>
</td>
<td>
JJCoen
</td>
<td>
2022-11-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/JJCoen/Misean/blob/2000cb73e8ec7558a8037ed888b58c4976503c24/analysis/Data-Management.Rmd" target="_blank">2000cb7</a>
</td>
<td>
JJCoen
</td>
<td>
2022-11-22
</td>
<td>
wflow_publish("analysis/Data-Management.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/JJCoen/Misean/723be95bfadb3e6ca388a878860047ea7b6aabf0/docs/Data-Management.html" target="_blank">723be95</a>
</td>
<td>
JJCoen
</td>
<td>
2022-11-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/JJCoen/Misean/blob/ac6180764490644675c6c2e41dc2f150ebe44463/analysis/Data-Management.Rmd" target="_blank">ac61807</a>
</td>
<td>
JJCoen
</td>
<td>
2022-11-22
</td>
<td>
wflow_publish("analysis/Data-Management.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/JJCoen/Misean/3560d293a4a8cdecded605f96250f90769f2c0e3/docs/Data-Management.html" target="_blank">3560d29</a>
</td>
<td>
JJCoen
</td>
<td>
2022-11-16
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/JJCoen/Misean/4fd749539931eca6047737ff9906c60d9b3f1304/docs/Data-Management.html" target="_blank">4fd7495</a>
</td>
<td>
JJCoen
</td>
<td>
2022-11-16
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/JJCoen/Misean/blob/3ec87e622c2fd58d3a2315b6d9a79f4a65a39508/analysis/Data-Management.Rmd" target="_blank">3ec87e6</a>
</td>
<td>
JJCoen
</td>
<td>
2022-11-16
</td>
<td>
add Data Analysis and Training
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="purpose" class="section level1">
<h1>Purpose</h1>
<p>Pre-process data so that it is amenable to analysis. Specifically,
generate the tables needed for creating a Donations Dashboard
displaying:</p>
<ol style="list-style-type: decimal">
<li>Summary of data, showing comparisons.</li>
<li>KPI: Donations Growth.</li>
<li>KPI: Value of donations.</li>
<li>KPI: Donor trend over time.</li>
</ol>
<p>Save tables to separate sheets in Excel Workbook.</p>
<div id="characteristics-of-clean-data-and-messy-data"
class="section level2">
<h2><strong>Characteristics of Clean Data and Messy Data</strong></h2>
<p>What exactly is clean data? Clean data is accurate, complete, and in
a format that is ready to analyze. Characteristics of clean data include
data that are:</p>
<ul>
<li>Free of duplicate rows/values</li>
<li>Error-free (e.g. free of misspellings)</li>
<li>Relevant (e.g. free of special characters)</li>
<li>The appropriate data type for analysis</li>
<li>Free of outliers (or only contain outliers have been
identified/understood), and</li>
<li>Follows a “tidy data” structure</li>
</ul>
<p>Common symptoms of messy data include data that contain:</p>
<ul>
<li>Special characters (e.g. commas in numeric values)</li>
<li>Numeric values stored as text/character data types</li>
<li>Duplicate rows</li>
<li>Misspellings</li>
<li>Inaccuracies</li>
<li>White space</li>
<li>Missing data</li>
<li>Zeros instead of null values</li>
</ul>
<p>Source: <a
href="https://www.dataquest.io/blog/load-clean-data-r-tidyverse/">Dataquest</a></p>
</div>
<div id="primary-research-question" class="section level2">
<h2>Primary Research Question</h2>
<p>How to calculate donations KPI’s and integrate results with Excel
WorkBook?</p>
</div>
<div id="load-data" class="section level2">
<h2>Load Data</h2>
<p>Donations to political parties from India, 12 Yrs data (2003-04 to
2014-15). <a
href="https://data.world/ambarishn/donations-to-political-parties">Source:
data.world</a>.</p>
<p>While there are some high value donations, most of the contributions
are below $500,000. The Data Summary shows individual donations up to a
value of $10,000,000. There are an additional 191 donations beyond that
value. These are not shown since they tend to skew the data.</p>
<p>Connect to Excel workbook and inspect names of sheets.</p>
<pre class="r"><code>donate_book &lt;- loadWorkbook(&quot;./data/donations-political-parties-India.xlsx&quot;)
getSheets(donate_book)</code></pre>
<pre><code>[1] &quot;Donation_data&quot;</code></pre>
<p>Store <code>Donation_data</code> sheet as a table.</p>
<pre class="r"><code>donations_dt &lt;- read_excel(&quot;./data/donations-political-parties-India.xlsx&quot;, sheet =&quot;Donation_data&quot;) %&gt;% 
  as.data.table()</code></pre>
<p>Remove columns having all missing entries and inspect the remaining
columns.</p>
<pre class="r"><code>donations_dt &lt;- donations_dt[, c(1:8)]
glimpse(donations_dt)</code></pre>
<pre><code>Rows: 13,573
Columns: 8
$ Party               &lt;chr&gt; &quot;CPI&quot;, &quot;CPI(M)&quot;, &quot;INC&quot;, &quot;INC&quot;, &quot;INC&quot;, &quot;BJP&quot;, &quot;BJP&quot;…
$ Name                &lt;chr&gt; &quot;Aziz Pasha&quot;, &quot;V K Ramachandran&quot;, &quot;Dr. Manmohan Si…
$ Type                &lt;chr&gt; &quot;Others&quot;, &quot;Others&quot;, &quot;Others&quot;, &quot;Others&quot;, &quot;Others&quot;, …
$ Address             &lt;chr&gt; &quot;16-B, Ferozeshah Road New Delhi-1&quot;, &quot;No.1, First …
$ `PAN Given`         &lt;chr&gt; &quot;Y&quot;, &quot;Y&quot;, &quot;N&quot;, &quot;N&quot;, &quot;N&quot;, &quot;Y&quot;, &quot;N&quot;, &quot;N&quot;, &quot;Y&quot;, &quot;N&quot;, …
$ Amount              &lt;dbl&gt; 3000000, 10000000, 108000, 54000, 54000, 100000, 1…
$ `Contribution Mode` &lt;chr&gt; &quot;CASH&quot;, &quot;000037, HDFC Bank Bengaluru, Dt. 16.03.20…
$ `Financial Year`    &lt;chr&gt; &quot;2010-11&quot;, &quot;2014-15&quot;, &quot;2014-15&quot;, &quot;2011-12&quot;, &quot;2011-…</code></pre>
</div>
</div>
<div id="pre-processing" class="section level1">
<h1>Pre-Processing</h1>
<div id="column-names" class="section level2">
<h2>1. Column names</h2>
<ol style="list-style-type: decimal">
<li>Replace space between column names with underscore and convert to
lower case.</li>
<li>Print column names.</li>
</ol>
<pre class="r"><code>if (!require(&quot;stringr&quot;)) install.packages(&quot;stringr&quot;)
library(&quot;stringr&quot;)
names(donations_dt) &lt;- str_replace_all(names(donations_dt), 
                                       &quot;\\s&quot;, &quot;_&quot;) %&gt;% 
  tolower()
colnames(donations_dt)</code></pre>
<pre><code>[1] &quot;party&quot;             &quot;name&quot;              &quot;type&quot;             
[4] &quot;address&quot;           &quot;pan_given&quot;         &quot;amount&quot;           
[7] &quot;contribution_mode&quot; &quot;financial_year&quot;   </code></pre>
</div>
<div id="missing-entries" class="section level2">
<h2><strong>2. Missing Entries</strong></h2>
<p>The <code>contribution_mode</code> column has 234 missing entries and
<code>address</code> has 1 missing. Replace these with `unknown`
designation.</p>
<pre class="r"><code>donations_dt[is.na(address), address := &quot;unknown&quot;]
donations_dt[is.na(contribution_mode), contribution_mode := &quot;unknown&quot;]</code></pre>
</div>
<div id="type-conversion" class="section level2">
<h2>3. Type Conversion</h2>
<div id="convert-financial_year-to-numeric" class="section level3">
<h3>Convert financial_year to numeric</h3>
<ol style="list-style-type: decimal">
<li>Strip last three characters from financial_year.</li>
<li>Convert single year from character to numeric.</li>
<li>Order donations table by year ascending.</li>
</ol>
<pre class="r"><code># Create new column named year
donations_dt[, year := str_sub(financial_year, end=-4)][, financial_year := NULL]
# Convert to numeric
donations_dt[, year := as.numeric(year)]                      
# Order data table by year
donations_dt &lt;- donations_dt[order(year)]</code></pre>
</div>
<div id="convert-year-from-numeric-to-categorical"
class="section level3">
<h3>Convert year from numeric to categorical</h3>
<p>This is in order to display axis marks correctly.</p>
<pre class="r"><code>donations_dt[, year_num := year][, year := as.factor(year)]</code></pre>
</div>
</div>
<div id="check-for-outliers" class="section level2">
<h2>4. Check for outliers</h2>
<pre class="r"><code>library(scales)   # to display values in thousands</code></pre>
<pre><code>
Attaching package: &#39;scales&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:purrr&#39;:

    discard</code></pre>
<pre><code>The following object is masked from &#39;package:readr&#39;:

    col_factor</code></pre>
<pre class="r"><code># Basic scatter plot
ggplot(donations_dt, aes(x=year, y=amount)) + 
  geom_point() +
  labs(title=&quot;Individual donations&quot;,
       x=&quot;Year&quot;, 
       y = &quot;Amount&quot;) +
  scale_y_continuous(label=comma ) </code></pre>
<p><img src="figure/Data-Management.Rmd/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(\rightarrow\)</span> There are eleven
contributions over $100 Million out of 13,573 separate donations. Since
these points skew the data, it is better to set the limit for
<code>amount</code> to $100 Million when plotting data. However, it is
necessary to retain these contributions for the sake of accuracy.</p>
</div>
</div>
<div id="key-performance-indicators" class="section level1">
<h1>Key Performance Indicators</h1>
<div id="donations-growth-over-time" class="section level2">
<h2>Donations growth over time</h2>
<p>Create a new table giving the total donations by year.</p>
<pre class="r"><code>options(&quot;scipen&quot;=100, &quot;digits&quot;=4)
donate_year &lt;- donations_dt[, .(year_sum = sum(amount)), by = year ]</code></pre>
<p>Visualise.</p>
<pre class="r"><code># Donations Growth
g2 &lt;- ggplot(donate_year, 
             aes(x=year, y = year_sum)) +
  geom_point(color = &quot;blue&quot;) +
  labs(title=&quot;Total Amount per Year&quot;,
       x=&quot;Year&quot;, 
       y = &quot;Annual Amount&quot;) +
  theme(legend.position=&quot;none&quot;) +
  # amount in thousands
  # scale_y_continuous(label=comma ) +
  # amount in Millions
    scale_y_continuous(labels = label_number(suffix = &quot; M&quot;, 
                                             scale = 1e-6),
                       n.breaks=6) +  
  theme(
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  ) +
  coord_flip()

g2</code></pre>
<p><img src="figure/Data-Management.Rmd/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<ol style="list-style-type: decimal">
<li>Write donations by year table to Excel Workbook.</li>
<li>Save updated Workbook</li>
</ol>
<pre class="r"><code>createSheet(donate_book, name =&quot;Donation_year&quot;)
writeWorksheet(donate_book, donate_year, sheet =&quot;Donation_year&quot;)</code></pre>
</div>
<div id="donor-growth" class="section level2">
<h2>Donor Growth</h2>
<p>Clean character strings in <code>name</code> column.</p>
<ol style="list-style-type: decimal">
<li>Remove punctuation marks.</li>
<li>Replace white-space with underscore</li>
</ol>
<pre class="r"><code># remove punctuation and replace whitespace with underscore
donations_dt$name &lt;- str_replace_all(donations_dt$name, 
                pattern = &quot;[[:punct:]]&quot;, 
                replacement = &quot;&quot;) 
donations_dt$name &lt;- str_replace_all(donations_dt$name, 
                pattern = &quot;\\s&quot;, 
                replacement = &quot;_&quot;) </code></pre>
<div id="unique-donors" class="section level3">
<h3>Unique Donors</h3>
<pre class="r"><code>donations_dt[, unique(name)] %&gt;% 
  length()</code></pre>
<pre><code>[1] 10807</code></pre>
<p>There are 10,807 unique donors out of 13,573 total donations given.
So, most donations are once-off.</p>
<ol style="list-style-type: decimal">
<li>Create a new table showing total amount each donor contributed.</li>
<li>Save table as a new Excel sheet in WorkBook.</li>
</ol>
<pre class="r"><code>by_donor &lt;- donations_dt[, .(tot_amount = sum(amount)), by=name]

createSheet(donate_book, name =&quot;Donation_donor&quot;)
writeWorksheet(donate_book, by_donor, sheet =&quot;Donation_donor&quot;)</code></pre>
</div>
<div id="donor-retention---single-year" class="section level3">
<h3>Donor retention - single year</h3>
<ol style="list-style-type: decimal">
<li>Create a table giving the donor, year of contribution, and amount
donor gave in each year.</li>
<li>Sum total amount given by individual donors by year.</li>
<li>Calculate the donor retention between 2013 and 2014.</li>
</ol>
<pre class="r"><code>donor_by_year &lt;- donations_dt[, .(sum(amount)), 
                              by = .(year_num, name)]
setnames(donor_by_year, &quot;V1&quot;, &quot;year_amount&quot;)

donors_13 &lt;- donor_by_year[year_num == 2013, name]
donors_14 &lt;- donor_by_year[year_num == 2014, name]

# donors in 2014 but not in 2013
setdiff(donors_14, donors_13) %&gt;% 
  length()</code></pre>
<pre><code>[1] 1227</code></pre>
<pre class="r"><code># donors who gave in 2013 and in 2014
num_retain &lt;- intersect(donors_14, donors_13) %&gt;% 
  length

num_retain/length(donors_14) * 100</code></pre>
<pre><code>[1] 13.41</code></pre>
</div>
<div id="donor-retention---all-previous-years" class="section level3">
<h3>Donor retention - all previous years</h3>
<pre class="r"><code>donors_previous &lt;- donor_by_year[year_num %in% 2003:2013, name]

# donors who gave in 2014 and in any previous year
num_retain_all &lt;- intersect(donors_14, donors_previous) %&gt;% 
  length

num_retain_all/length(donors_14) * 100</code></pre>
<pre><code>[1] 18.28</code></pre>
</div>
</div>
<div id="number-of-donors" class="section level2">
<h2>Number of Donors</h2>
<p>Number of donors making contributions per year.</p>
<pre class="r"><code>contributions &lt;-  donations_dt[, .N, by = year]
contributions[, year := seq.int(from = 2003, to = 2014, 
                                by = 1)]
createSheet(donate_book, name =&quot;Contributions&quot;)
writeWorksheet(donate_book, contributions, sheet =&quot;Contributions&quot;)</code></pre>
</div>
<div id="store-data" class="section level2">
<h2>Store Data</h2>
<ol style="list-style-type: decimal">
<li>Save R tables in RData file.</li>
<li>Write to Excel WorkBook file containing separate sheets for each new
table.</li>
</ol>
<pre class="r"><code># Save RData
save(by_donor, donate_year, contributions, donations_dt, 
     file = &quot;./data/donate.RData&quot;)

# Excel WorkBook
saveWorkbook(donate_book, file = &quot;./data/donations-India-update.xlsx&quot;)</code></pre>
</div>
<div id="numeric-columns" class="section level2">
<h2>Numeric Columns</h2>
<div id="normalization" class="section level3">
<h3><strong>Normalization</strong></h3>
<p>Another common task is centering and scaling numeric variables, known
as normalization. For each numeric column, we subtract the mean and
divide by the standard deviation. This transforms numeric variables to
standard deviation units with a mean of 0 and standard deviation of 1.
Interpreting normalized variable values is very intuitive. From the
normalized total_time value, we see that spending 1,273 seconds on the
website is 1-point-19 standard deviations greater than the average time
spent by customers.</p>
</div>
</div>
<div id="section" class="section level2">
<h2></h2>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.2 (2022-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 22000)

Matrix products: default

locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] scales_1.2.1      readxl_1.4.1      forcats_0.5.2     stringr_1.4.1    
 [5] purrr_0.3.5       readr_2.1.3       tibble_3.1.8      tidyverse_1.3.2  
 [9] skimr_2.1.4       kableExtra_1.3.4  data.table_1.14.4 visdat_0.5.3     
[13] ggplot2_3.4.0     dplyr_1.0.10      tidyr_1.2.1       XLConnect_1.0.6  
[17] workflowr_1.7.0  

loaded via a namespace (and not attached):
 [1] httr_1.4.4          sass_0.4.2          jsonlite_1.8.3     
 [4] viridisLite_0.4.1   modelr_0.1.10       bslib_0.4.1        
 [7] assertthat_0.2.1    getPass_0.2-2       highr_0.9          
[10] googlesheets4_1.0.1 cellranger_1.1.0    yaml_2.3.6         
[13] pillar_1.8.1        backports_1.4.1     glue_1.6.2         
[16] digest_0.6.30       promises_1.2.0.1    rvest_1.0.3        
[19] colorspace_2.0-3    htmltools_0.5.3     httpuv_1.6.6       
[22] pkgconfig_2.0.3     broom_1.0.1         haven_2.5.1        
[25] webshot_0.5.4       processx_3.8.0      svglite_2.1.0      
[28] whisker_0.4         later_1.3.0         tzdb_0.3.0         
[31] timechange_0.1.1    git2r_0.30.1        googledrive_2.0.0  
[34] farver_2.1.1        generics_0.1.3      ellipsis_0.3.2     
[37] cachem_1.0.6        withr_2.5.0         repr_1.1.4         
[40] cli_3.3.0           crayon_1.5.2        magrittr_2.0.3     
[43] evaluate_0.18       ps_1.7.2            fs_1.5.2           
[46] fansi_1.0.3         xml2_1.3.3          tools_4.2.2        
[49] hms_1.1.2           gargle_1.2.1        lifecycle_1.0.3    
[52] reprex_2.0.2        munsell_0.5.0       callr_3.7.3        
[55] compiler_4.2.2      jquerylib_0.1.4     systemfonts_1.0.4  
[58] rlang_1.0.6         grid_4.2.2          rstudioapi_0.14    
[61] labeling_0.4.2      base64enc_0.1-3     rmarkdown_2.18     
[64] gtable_0.3.1        DBI_1.1.3           R6_2.5.1           
[67] lubridate_1.9.0     knitr_1.40          fastmap_1.1.0      
[70] utf8_1.2.2          rprojroot_2.0.3     rJava_1.0-6        
[73] stringi_1.7.8       Rcpp_1.0.9          vctrs_0.5.0        
[76] dbplyr_2.2.1        tidyselect_1.2.0    xfun_0.31          </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
